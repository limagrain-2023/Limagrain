{"utilities":{},"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"ISPGetVATCodes":{"sourceUuid":"508ac32e-ae10-4688-a843-f94531ab82b8","name":"ISPGetVATCodes","program":"EXT001MI","description":"ALL_MI_0001_GetVATCodes","active":true,"multi":true,"modified":1678451218010,"modifiedBy":"APE_SMA","outputFields":[{"name":"DIVI","description":"division","length":3,"mandatory":false,"type":"A"},{"name":"VTCD","description":"VAT code","length":2,"mandatory":false,"type":"N"},{"name":"TX40","description":"description","length":40,"mandatory":false,"type":"A"},{"name":"VTD1","description":"nondeductible VAT 1","length":5,"mandatory":false,"type":"N"},{"name":"VTP1","description":"VAT rate 1","length":5,"mandatory":false,"type":"N"},{"name":"VTD2","description":"nondeductible VAT 2","length":5,"mandatory":false,"type":"N"},{"name":"VTP2","description":"VAT rate 2","length":5,"mandatory":false,"type":"N"},{"name":"FRDT","description":"from date","length":8,"mandatory":false,"type":"N"},{"name":"ONSR","description":"VAT on service","length":1,"mandatory":false,"type":"A"},{"name":"VATT","description":"VAT method","length":20,"mandatory":false,"type":"N"},{"name":"CSCD","description":"country","length":3,"mandatory":false,"type":"A"}],"inputFields":[],"utilities":[]}},"batches":{}}},"sources":{"508ac32e-ae10-4688-a843-f94531ab82b8":{"uuid":"508ac32e-ae10-4688-a843-f94531ab82b8","updated":1678451199074,"updatedBy":"APE_SMA","created":1671807143742,"createdBy":"RLO","apiVersion":"0.9","beVersion":"16.0.0.20221210044646.5","codeHash":"45C914E51D995BC38999BC0CEFAE9E6388D2F3D0A4503123CDF1622D3BAB3199","code":"LyoqDQoqIFJFQURNRQ0KKiBUaGlzIGV4dGVuc2lvbiBzZW5kcyBNMyBWQVQgY29kZSBkZXRhaWxzIHRvIDNyZCBwYXJ0eSBhcHBsaWNhdGlvbiBJU1AuIA0KKiANCioNCiogTmFtZTogRVhUMDAxTUkuSVNQR2V0VkFUQ29kZXMNCiogRGVzY3JpcHRpb246IA0KKiBEYXRlICAgICAgICAgIENoYW5nZWQgYnkgICAgICAgICAgICAgIERlc2NyaXB0aW9uDQoqIDIwMjEtMDUtMTkgICAgSGl0ZXNoIENob3RyYW5pICAgICAgICAgSW5pdGlhbCB2ZXJzaW9uDQoqIDIwMjMtMDMtMTAgICAgU2hhc2hhbmsgTWFsYWxpICAgICAgICAgUmVtb3ZlIHVudXNlZCBjb2RlLCB1c2FnZSBsb3dlckNhbWVsQ2FzZQ0KKiAgDQoqLw0KDQoNCnB1YmxpYyBjbGFzcyBJU1BHZXRWQVRDb2RlcyBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gew0KICBwcml2YXRlIGZpbmFsIE1JQVBJIG1pOw0KICBwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsNCiAgcHJpdmF0ZSBmaW5hbCBNSUNhbGxlckFQSSBtaUNhbGxlcjsNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZTsNCiAgcHJpdmF0ZSBTdHJpbmcgQ09OTyA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBzdGFydERJVkkgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgaWdub3JlQmxhbmtEaXZpc2lvbiA9ICIiOw0KICBwcml2YXRlIEFycmF5TGlzdCA8IFN0cmluZyA+IG1ldGhvZFBvc2l0aW9uTGlzdCA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgU3RyaW5nID4gb25TZXJ2aWNlUG9zaXRpb25MaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBTdHJpbmcgPiBkaXZpc2lvbkxpc3QgPSBudWxsOw0KICBwcml2YXRlIGJvb2xlYW4gaGFzRGF0YSA9IGZhbHNlOw0KDQogIHB1YmxpYyBJU1BHZXRWQVRDb2RlcyhNSUFQSSBtaSwgUHJvZ3JhbUFQSSBwcm9ncmFtLCBNSUNhbGxlckFQSSBtaUNhbGxlciwgRGF0YWJhc2VBUEkgZGF0YWJhc2UpIHsNCiAgICB0aGlzLm1pID0gbWk7DQogICAgdGhpcy5taUNhbGxlciA9IG1pQ2FsbGVyOw0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW07DQogICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlOw0KICB9DQoNCiAgcHVibGljIHZvaWQgbWFpbigpIHsNCiAgICBDT05PID0gcHJvZ3JhbS5MREFaRC5nZXQoJ0NPTk8nKTsNCiAgICBwb3B1bGF0ZUNvbnRyb2xQcm9wZXJ0aWVzKCk7DQogICAgaWYgKGlnbm9yZUJsYW5rRGl2aXNpb24udHJpbSgpLmVxdWFscygiMSIpKSB7DQogICAgICBzdGFydERJVkkgPSAiMCI7DQogICAgfQ0KICAgIGdhdGhlckFsbERpdmlzaW9ucygpOw0KICAgIGRpdmlzaW9uTGlzdC5lYWNoIHsNCiAgICAgIHZhbHVlIC0+DQogICAgICAgIFN0cmluZyBlYWNoRGl2aXNpb24gPSB2YWx1ZTsNCiAgICAgIGlmIChlYWNoRGl2aXNpb24udHJpbSgpLmlzRW1wdHkoKSAmJiBpZ25vcmVCbGFua0RpdmlzaW9uID09ICIxIikgew0KICAgICAgICANCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGdldFZBVENvZGVzKGVhY2hEaXZpc2lvbik7DQogICAgICAgIGdldFplcm9WQVRDb2RlKGVhY2hEaXZpc2lvbik7DQogICAgICB9DQogICAgfQ0KDQogICAgaWYgKGhhc0RhdGEpIHsNCiAgICAgIG1pLm91dERhdGEucHV0KCdUWDQwJywgJyUlRU9GJSUnKTsNCiAgICAgIG1pLndyaXRlKCk7DQogICAgfQ0KICB9DQoNCiAgLyoqDQogICAqIEdldCBjb250cm9sIHByb3BlcnRpZXMgZnJvbSBDVUdFWDENCiAgICogDQogICAqLw0KDQogIHB1YmxpYyBwb3B1bGF0ZUNvbnRyb2xQcm9wZXJ0aWVzKCkgew0KDQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgaWdub3JlQmxhbmtEaXZpc2lvbiA9IHJlc3VsdHMuZ2V0KCdBMTIxJyk7DQoNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJQbGVhc2UgbWFpbnRhaW4gcmVjb3JkIGluIENVR0VYMSBmb3IgSUdOT1JFQkxBTktESVZJIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtcyA9IFsiRklMRSI6ICJJU1BGSUxFIiwgIlBLMDEiOiAiR0VUVkFUQ09ERVMiLCAiUEswMiI6ICJJR05PUkVCTEFOS0RJVkkiXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDVVNFWFRNSSIsICJHZXRGaWVsZFZhbHVlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQoNCiAgICBtZXRob2RQb3NpdGlvbkxpc3QgPSBuZXcgQXJyYXlMaXN0IDwgU3RyaW5nID4gKCk7DQogICAgcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2syID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBTdHJpbmcgbWV0aG9kUG9zaXRpb25zID0gcmVzdWx0cy5nZXQoJ0ExMjEnKTsNCiAgICAgICAgU3RyaW5nW10gbWV0aG9kUG9zaXRpb25zQXJyYXkgPSBtZXRob2RQb3NpdGlvbnMuc3BsaXQoJzsnKTsNCiAgICAgICAgbWV0aG9kUG9zaXRpb25zQXJyYXkuZWFjaCB7DQogICAgICAgICAgdmFsdWUgLT4NCiAgICAgICAgICAgIFN0cmluZyBtZXRob2RQb3NpdGlvbiA9IHZhbHVlOw0KICAgICAgICAgIG1ldGhvZFBvc2l0aW9uTGlzdC5hZGQobWV0aG9kUG9zaXRpb24udHJpbSgpKTsNCg0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5lcnJvcigiUGxlYXNlIG1haW50YWluIHJlY29yZCBpbiBDVUdFWDEgZm9yIE1FVEhPRFBPU0lUSU9OIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtczIgPSBbIkZJTEUiOiAiSVNQRklMRSIsICJQSzAxIjogIkdFVFZBVENPREVTIiwgIlBLMDIiOiAiTUVUSE9EUE9TSVRJT04iXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDVVNFWFRNSSIsICJHZXRGaWVsZFZhbHVlIiwgcGFyYW1zMiwgY2FsbGJhY2syKTsNCg0KICAgIG9uU2VydmljZVBvc2l0aW9uTGlzdCA9IG5ldyBBcnJheUxpc3QgPCBTdHJpbmcgPiAoKTsNCg0KICAgIHJlY29yZEV4aXN0cyA9IHRydWU7DQogICAgZGVmIGNhbGxiYWNrMyA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgU3RyaW5nIG9uU2VydmljZVBvc2l0aW9ucyA9IHJlc3VsdHMuZ2V0KCdBMTIxJyk7DQogICAgICAgIFN0cmluZ1tdIG9uU2VydmljZVBvc2l0aW9uc0FycmF5ID0gb25TZXJ2aWNlUG9zaXRpb25zLnNwbGl0KCc7Jyk7DQogICAgICAgIG9uU2VydmljZVBvc2l0aW9uc0FycmF5LmVhY2ggew0KICAgICAgICAgIHZhbHVlIC0+DQogICAgICAgICAgICBTdHJpbmcgb25TZXJ2aWNlUG9zaXRpb24gPSB2YWx1ZTsNCiAgICAgICAgICBvblNlcnZpY2VQb3NpdGlvbkxpc3QuYWRkKG9uU2VydmljZVBvc2l0aW9uLnRyaW0oKSk7DQoNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWkuZXJyb3IoIlBsZWFzZSBtYWludGFpbiByZWNvcmQgaW4gQ1VHRVgxIGZvciBPTlNFUlZJQ0VQT1NJVElPTiIpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgfQ0KICAgIGRlZiBwYXJhbXMzID0gWyJGSUxFIjogIklTUEZJTEUiLCAiUEswMSI6ICJHRVRWQVRDT0RFUyIsICJQSzAyIjogIk9OU0VSVklDRVBPU0lUSU9OIl07DQogICAgbWlDYWxsZXIuY2FsbCgiQ1VTRVhUTUkiLCAiR2V0RmllbGRWYWx1ZSIsIHBhcmFtczMsIGNhbGxiYWNrMyk7DQoNCiAgfQ0KDQogIC8qKg0KICAgKiBMaXN0IGFsbCBNMyBkaXZpc2lvbnMNCiAgICogDQogICAqLw0KICBwdWJsaWMgZ2F0aGVyQWxsRGl2aXNpb25zKCkgew0KICAgIGRpdmlzaW9uTGlzdCA9IG5ldyBBcnJheUxpc3QgPCBTdHJpbmcgPiAoKTsNCiAgICBib29sZWFuIHJlY29yZEV4aXN0cyA9IHRydWU7DQogICAgZGVmIGNhbGxiYWNrID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBTdHJpbmcgRElWSSA9IHJlc3VsdHMuZ2V0KCdESVZJJyk7DQogICAgICAgIGRpdmlzaW9uTGlzdC5hZGQoRElWSS50cmltKCkpOw0KDQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5lcnJvcigiTm8gRGl2aXNpb25zIGZvdW5kIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtcyA9IFsiQ09OTyI6IENPTk8sICJESVZJIjogc3RhcnRESVZJXTsNCiAgICBtaUNhbGxlci5jYWxsKCJNTlMxMDBNSSIsICJMc3REaXZpc2lvbnMiLCBwYXJhbXMsIGNhbGxiYWNrKTsNCiAgfQ0KDQogIC8qKg0KICAgKiBSZWFkIGFsbCBWQVQgY29kZSANCiAgICogDQogICAqLw0KDQogIHB1YmxpYyBnZXRWQVRDb2RlcyhTdHJpbmcgZWFjaERpdmlzaW9uKSB7DQogICAgREJBY3Rpb24gcXVlcnlDVkFUUEMgPSBkYXRhYmFzZS50YWJsZSgiQ1ZBVFBDIikNCiAgICAgIC5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkNWQ09OTyIsICJDVkRJVkkiLCAiQ1ZWVENEIiwgIkNWRlJEVCIsICJDVlRYNDAiLCAiQ1ZWVFAxIiwgIkNWVlRQMiIsICJDVlZURDEiLCAiQ1ZWVEQyIiwgIkNWQ1NDRCIpDQogICAgICAuYnVpbGQoKQ0KICAgIERCQ29udGFpbmVyIHJlY29yZENWQVRQQyA9IHF1ZXJ5Q1ZBVFBDLmdldENvbnRhaW5lcigpDQogICAgcmVjb3JkQ1ZBVFBDLnNldCgiQ1ZDT05PIiwgQ09OTy50b0ludGVnZXIoKSk7DQogICAgcmVjb3JkQ1ZBVFBDLnNldCgiQ1ZESVZJIiwgZWFjaERpdmlzaW9uKTsNCiAgICANCiAgICBpbnQgcmVhZHMgPSBxdWVyeUNWQVRQQy5yZWFkQWxsKHJlY29yZENWQVRQQywgMiwgZ2V0Q1ZBVFBDUmVjb3Jkcyk7DQoNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gZ2V0Q1ZBVFBDUmVjb3JkcyA9IHsNCiAgICBEQkNvbnRhaW5lciByZWNvcmQgLT4NCiAgICBTdHJpbmcgVlRDRCA9IHJlY29yZC5nZXQoIkNWVlRDRCIpOw0KICAgIFN0cmluZyBESVZJID0gcmVjb3JkLmdldCgiQ1ZESVZJIik7DQogICAgU3RyaW5nIEZSRFQgPSByZWNvcmQuZ2V0KCJDVkZSRFQiKTsNCiAgICBTdHJpbmcgVFg0MCA9IHJlY29yZC5nZXQoIkNWVFg0MCIpOw0KICAgIFN0cmluZyBWVFAxID0gcmVjb3JkLmdldCgiQ1ZWVFAxIik7DQogICAgU3RyaW5nIFZUUDIgPSByZWNvcmQuZ2V0KCJDVlZUUDIiKTsNCiAgICBTdHJpbmcgVlREMSA9IHJlY29yZC5nZXQoIkNWVlREMSIpOw0KICAgIFN0cmluZyBWVEQyID0gcmVjb3JkLmdldCgiQ1ZWVEQyIik7DQogICAgU3RyaW5nIENTQ0QgPSByZWNvcmQuZ2V0KCJDVkNTQ0QiKTsNCiAgICBWVENEID0gU3RyaW5nLmZvcm1hdCgiJTAyZCIsIFZUQ0QudHJpbSgpLnRvSW50ZWdlcigpKTsNCiAgICBTdHJpbmdbXSB2YXREZXRhaWxzID0gZ2V0VmF0RGV0YWlscyhWVENELCBESVZJKTsNCiAgICBpZiAodmF0RGV0YWlscy5sZW5ndGggPT0gMikgew0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZBVFQnLCB2YXREZXRhaWxzWzBdKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPTlNSJywgdmF0RGV0YWlsc1sxXSk7DQogICAgfQ0KICAgIG1pLm91dERhdGEucHV0KCdWVENEJywgVlRDRCk7DQogICAgbWkub3V0RGF0YS5wdXQoJ0RJVkknLCBESVZJKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnRlJEVCcsIEZSRFQpOw0KICAgIG1pLm91dERhdGEucHV0KCdUWDQwJywgVFg0MCk7DQogICAgbWkub3V0RGF0YS5wdXQoJ1ZUUDEnLCBWVFAxKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnVlRQMicsIFZUUDIpOw0KICAgIG1pLm91dERhdGEucHV0KCdWVEQxJywgVlREMSk7DQogICAgbWkub3V0RGF0YS5wdXQoJ1ZURDInLCBWVEQyKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnQ1NDRCcsIENTQ0QpOw0KICAgIG1pLndyaXRlKCk7DQogICAgaGFzRGF0YSA9IHRydWU7DQoNCiAgfQ0KDQogIC8qKg0KICAgKiBEZXBlbmQgdXBvbiBjb250cm9sIHByb3BlcnR5IGdldCBWQVQgY29kZSBkZXRhaWxzDQogICAqIA0KICAgKi8NCiAgcHVibGljIFN0cmluZ1tdIGdldFZhdERldGFpbHMoU3RyaW5nIFZUQ0QsIFN0cmluZyBESVZJKSB7DQogICAgU3RyaW5nW10gdmF0RGV0YWlscyA9IG5ldyBTdHJpbmdbMl07DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgU3RyaW5nIFBBUk0gPSByZXN1bHRzLmdldCgnUEFSTScpOw0KICAgICAgICBpbnQgbWV0aG9kU3RhcnRQb3NpdGlvbiA9IG1ldGhvZFBvc2l0aW9uTGlzdC5nZXQoMCkudG9JbnRlZ2VyKCk7DQogICAgICAgIGludCBtZXRob2RQb3NpdGlvbkxlbmd0aCA9IG1ldGhvZFBvc2l0aW9uTGlzdC5nZXQoMSkudG9JbnRlZ2VyKCk7DQogICAgICAgIGludCBvblNlcnZpY2VTdGFydFBvc2l0aW9uID0gb25TZXJ2aWNlUG9zaXRpb25MaXN0LmdldCgwKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG9uU2VydmljZUxlbmd0aCA9IG9uU2VydmljZVBvc2l0aW9uTGlzdC5nZXQoMSkudG9JbnRlZ2VyKCk7DQoNCiAgICAgICAgU3RyaW5nIFZBVFQgPSBQQVJNLmxlbmd0aCgpIDwgbWV0aG9kU3RhcnRQb3NpdGlvbiArIG1ldGhvZFBvc2l0aW9uTGVuZ3RoID8gIiIgOiBQQVJNLnN1YnN0cmluZyhtZXRob2RTdGFydFBvc2l0aW9uLCBtZXRob2RTdGFydFBvc2l0aW9uICsgbWV0aG9kUG9zaXRpb25MZW5ndGgpOw0KICAgICAgICBTdHJpbmcgVkFUT25TZXJ2aWNlcyA9IFBBUk0ubGVuZ3RoKCkgPCBvblNlcnZpY2VTdGFydFBvc2l0aW9uICsgb25TZXJ2aWNlTGVuZ3RoID8gIiIgOiBQQVJNLnN1YnN0cmluZyhvblNlcnZpY2VTdGFydFBvc2l0aW9uLCBvblNlcnZpY2VTdGFydFBvc2l0aW9uICsgb25TZXJ2aWNlTGVuZ3RoKTsNCiAgICAgICAgdmF0RGV0YWlsc1swXSA9IFZBVFQ7DQogICAgICAgIHZhdERldGFpbHNbMV0gPSBWQVRPblNlcnZpY2VzOw0KICAgICAgfQ0KDQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiRElWSSI6IERJVkksICJTVENPIjogIlZUQ0QiLCAiU1RLWSI6IFZUQ0RdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzE3NU1JIiwgIkdldEdlbmVyYWxDb2RlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogICAgcmV0dXJuIHZhdERldGFpbHM7DQogIH0NCg0KICAvKioNCiAgICogRGVwZW5kIHVwb24gY29udHJvbCBwcm9wZXJ0eSBnZXQgVkFUIGNvZGUgZGV0YWlscw0KICAgKiANCiAgICovDQogIHB1YmxpYyBnZXRaZXJvVkFUQ29kZShTdHJpbmcgZWFjaERpdmlzaW9uKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgU3RyaW5nIFRYNDAgPSByZXN1bHRzLmdldCgnVFg0MCcpOw0KICAgICAgICBTdHJpbmcgUEFSTSA9IHJlc3VsdHMuZ2V0KCdQQVJNJyk7DQogICAgICAgIGludCBtZXRob2RTdGFydFBvc2l0aW9uID0gbWV0aG9kUG9zaXRpb25MaXN0LmdldCgwKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG1ldGhvZFBvc2l0aW9uTGVuZ3RoID0gbWV0aG9kUG9zaXRpb25MaXN0LmdldCgxKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG9uU2VydmljZVN0YXJ0UG9zaXRpb24gPSBvblNlcnZpY2VQb3NpdGlvbkxpc3QuZ2V0KDApLnRvSW50ZWdlcigpOw0KICAgICAgICBpbnQgb25TZXJ2aWNlTGVuZ3RoID0gb25TZXJ2aWNlUG9zaXRpb25MaXN0LmdldCgxKS50b0ludGVnZXIoKTsNCg0KICAgICAgICBTdHJpbmcgVkFUVCA9IFBBUk0ubGVuZ3RoKCkgPCBtZXRob2RTdGFydFBvc2l0aW9uICsgbWV0aG9kUG9zaXRpb25MZW5ndGggPyAiIiA6IFBBUk0uc3Vic3RyaW5nKG1ldGhvZFN0YXJ0UG9zaXRpb24sIG1ldGhvZFN0YXJ0UG9zaXRpb24gKyBtZXRob2RQb3NpdGlvbkxlbmd0aCk7DQoNCiAgICAgICAgU3RyaW5nIFZBVE9uU2VydmljZXMgPSBQQVJNLmxlbmd0aCgpIDwgb25TZXJ2aWNlU3RhcnRQb3NpdGlvbiArIG9uU2VydmljZUxlbmd0aCA/ICIiIDogUEFSTS5zdWJzdHJpbmcob25TZXJ2aWNlU3RhcnRQb3NpdGlvbiwgb25TZXJ2aWNlU3RhcnRQb3NpdGlvbiArIG9uU2VydmljZUxlbmd0aCk7DQogICAgICAgIG1pLm91dERhdGEucHV0KCdESVZJJywgZWFjaERpdmlzaW9uKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZUQ0QnLCAiMDAiKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1RYNDAnLCBUWDQwKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ09OU1InLCBWQVRPblNlcnZpY2VzKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZBVFQnLCBWQVRUKTsNCiAgICAgICAgbWkud3JpdGUoKTsNCiAgICAgIH0NCg0KICAgIH0NCiAgICBkZWYgcGFyYW1zID0gWyJDT05PIjogQ09OTywgIkRJVkkiOiBlYWNoRGl2aXNpb24sICJTVENPIjogIlZUQ0QiLCAiU1RLWSI6ICIwMCJdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzE3NU1JIiwgIkdldEdlbmVyYWxDb2RlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogIH0NCn0="}}}